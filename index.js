const _0x185ed8=_0x3844;(function(_0x1eb289,_0x2da109){const _0xa899ef=_0x3844,_0x1b6a88=_0x1eb289();while(!![]){try{const _0x593821=-parseInt(_0xa899ef(0x14a))/0x1+parseInt(_0xa899ef(0x154))/0x2+-parseInt(_0xa899ef(0x160))/0x3*(-parseInt(_0xa899ef(0x152))/0x4)+-parseInt(_0xa899ef(0x14c))/0x5*(parseInt(_0xa899ef(0x178))/0x6)+-parseInt(_0xa899ef(0x16b))/0x7+-parseInt(_0xa899ef(0x166))/0x8*(parseInt(_0xa899ef(0x165))/0x9)+parseInt(_0xa899ef(0x168))/0xa;if(_0x593821===_0x2da109)break;else _0x1b6a88['push'](_0x1b6a88['shift']());}catch(_0x406485){_0x1b6a88['push'](_0x1b6a88['shift']());}}}(_0x34f7,0x45286));import{createDrawer}from'./ui/drawer.js';import'./MiZheSi/index.js';import{registerSlashCommands}from'./core/commands.js';import{onMessageReceived,onChatChanged}from'./core/events.js';function _0x3844(_0xa6cefc,_0x2ef7f8){const _0x34f744=_0x34f7();return _0x3844=function(_0x3844b2,_0x550e81){_0x3844b2=_0x3844b2-0x143;let _0x25c3c8=_0x34f744[_0x3844b2];return _0x25c3c8;},_0x3844(_0xa6cefc,_0x2ef7f8);}import{eventSource,event_types}from'/script.js';import{checkForUpdates}from'./core/api.js';import{setUpdateInfo}from'./ui/state.js';import{pluginVersion,extensionName,defaultSettings}from'./utils/settings.js';import{extension_settings}from'/scripts/extensions.js';function compareVersions(_0x5e8ad5,_0x40c3ab){const _0x21e639=_0x3844,_0x18a7df=_0x5e8ad5[_0x21e639(0x15f)]('.')[_0x21e639(0x16e)](Number),_0x43f777=_0x40c3ab['split']('.')[_0x21e639(0x16e)](Number),_0x4fd8f4=Math[_0x21e639(0x169)](_0x18a7df[_0x21e639(0x148)],_0x43f777['length']);for(let _0x443b2f=0x0;_0x443b2f<_0x4fd8f4;_0x443b2f++){const _0x444012=_0x18a7df[_0x443b2f]||0x0,_0x223977=_0x43f777[_0x443b2f]||0x0;if(_0x444012>_0x223977)return!![];if(_0x444012<_0x223977)return![];}return![];}async function handleUpdateCheck(){const _0x5c751c=_0x3844;console[_0x5c751c(0x167)](_0x5c751c(0x14d));const _0x5b70ae=await checkForUpdates();if(_0x5b70ae&&_0x5b70ae[_0x5c751c(0x170)]){const _0x1e2f50=compareVersions(_0x5b70ae['version'],pluginVersion);_0x1e2f50?console[_0x5c751c(0x167)](_0x5c751c(0x153)+_0x5b70ae[_0x5c751c(0x170)]+_0x5c751c(0x149)):console[_0x5c751c(0x167)]('【Amily2号-情报部】一切安好，帝国已是最新版本。情报已转交内务府备案。'),setUpdateInfo(_0x1e2f50,_0x5b70ae);}}function _0x34f7(){const _0x3ad30a=['appendChild','historiography.css','text/css','error','MESSAGE_RECEIVED','[Amily2号-开国大典]\x20步骤四：部署帝国哨兵网络...','690EdvyJA','?v=','now','createElement','hanlinyuan.css','#sys-settings-button','type','href','amily2EventsRegistered','[Amily2号-开国大典]\x20步骤二：皇家仪仗队就位...','【Amily2号】帝国秩序已完美建立。Amily2号的府邸已恭候陛下的莅临。','length','。情报已转交内务府。','269837oHPHMJ','message','7495IaLAve','【Amily2号】帝国已就绪，现派遣外交官，为陛下探查外界新情报...','rel','scripts/extensions/third-party/','/assets/','amily2-style-','4OveqDP','【Amily2号-情报部】捷报！发现新版本:\x20','226178KdtkaM','getElementById','[Amily2号-开国大典]\x20步骤一：为宫殿披上华服...','includes','stack','严重错误','[Amily2号-帝国枢密院]\x20开始执行开国大典...','head','addEventListener','[Amily2号-帝国枢密院]\x20帝国基本法已确认，档案室已与国库对接完毕。','link','split','859659uuCLQs','\x20超时。','style.css','未知错误','ST-Amily2-Chat-Optimisation','1225566ojHKxT','24pClRVB','log','8790230cnWiwH','max','[Amily2号-开国大典]\x20步骤三：开始召唤府邸...','1012557tSHswK','[Amily2号]\x20部署失败：等待\x20','!!!【开国大典失败】在执行系列法令时发生严重错误:','map','[Amily2-全局卫队]\x20捕获到严重错误:','version','[Amily2号-皇家制衣局]\x20已为帝国披上华服:\x20'];_0x34f7=function(){return _0x3ad30a;};return _0x34f7();}function loadPluginStyles(){const _0x361282=_0x3844,_0x4e9134=_0x447474=>{const _0x4f9f53=_0x3844,_0x4a9af8=_0x4f9f53(0x151)+_0x447474[_0x4f9f53(0x15f)]('.')[0x0];if(document[_0x4f9f53(0x155)](_0x4a9af8))return;const _0x321b5f=_0x4f9f53(0x14f)+extensionName+_0x4f9f53(0x150)+_0x447474+_0x4f9f53(0x179)+Date[_0x4f9f53(0x17a)](),_0x4edb66=document[_0x4f9f53(0x17b)](_0x4f9f53(0x15e));_0x4edb66['id']=_0x4a9af8,_0x4edb66[_0x4f9f53(0x14e)]='stylesheet',_0x4edb66[_0x4f9f53(0x143)]=_0x4f9f53(0x174),_0x4edb66[_0x4f9f53(0x144)]=_0x321b5f,document[_0x4f9f53(0x15b)][_0x4f9f53(0x172)](_0x4edb66),console[_0x4f9f53(0x167)](_0x4f9f53(0x171)+_0x447474);};_0x4e9134(_0x361282(0x162)),_0x4e9134(_0x361282(0x173)),_0x4e9134(_0x361282(0x17c));}window[_0x185ed8(0x15c)](_0x185ed8(0x175),_0x49473e=>{const _0xbcb067=_0x185ed8,_0x7ca171=_0x49473e[_0xbcb067(0x175)]?.[_0xbcb067(0x158)]||'';_0x7ca171[_0xbcb067(0x157)](_0xbcb067(0x164))&&(console[_0xbcb067(0x175)](_0xbcb067(0x16f),_0x49473e['error']),toastr['error']('Amily2插件错误:\x20'+(_0x49473e[_0xbcb067(0x175)]?.[_0xbcb067(0x14b)]||_0xbcb067(0x163)),_0xbcb067(0x159),{'timeOut':0x2710}));}),jQuery(async()=>{const _0x16ff4e=_0x185ed8;console['log'](_0x16ff4e(0x15a));!extension_settings[extensionName]&&(extension_settings[extensionName]={});Object['assign'](extension_settings[extensionName],{...defaultSettings,...extension_settings[extensionName]}),console[_0x16ff4e(0x167)](_0x16ff4e(0x15d));let _0x57cc26=0x0;const _0x29391f=0x64,_0x24bf8d=0x64,_0x4914ef=_0x16ff4e(0x17d),_0x274a74=setInterval(async()=>{const _0x2c63b9=_0x16ff4e;if($(_0x4914ef)[_0x2c63b9(0x148)]>0x0){clearInterval(_0x274a74),console[_0x2c63b9(0x167)]('[Amily2号-帝国枢密院]\x20SillyTavern宫殿主体已确认，开国大典正式开始！');try{console[_0x2c63b9(0x167)](_0x2c63b9(0x156)),loadPluginStyles(),console['log'](_0x2c63b9(0x146)),await registerSlashCommands(),console[_0x2c63b9(0x167)](_0x2c63b9(0x16a)),createDrawer(),console[_0x2c63b9(0x167)](_0x2c63b9(0x177)),!window[_0x2c63b9(0x145)]&&(eventSource['on'](event_types[_0x2c63b9(0x176)],onMessageReceived),eventSource['on'](event_types['IMPERSONATE_READY'],onMessageReceived),eventSource['on'](event_types['CHAT_CHANGED'],onChatChanged),window['amily2EventsRegistered']=!![]),console[_0x2c63b9(0x167)](_0x2c63b9(0x147)),handleUpdateCheck();}catch(_0xfe9366){console[_0x2c63b9(0x175)](_0x2c63b9(0x16d),_0xfe9366);}}else _0x57cc26++,_0x57cc26>=_0x29391f&&(clearInterval(_0x274a74),console[_0x2c63b9(0x175)](_0x2c63b9(0x16c)+_0x4914ef+_0x2c63b9(0x161)));},_0x24bf8d);});
