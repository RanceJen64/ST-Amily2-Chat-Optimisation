const _0x5a7bc1=_0x56e0;(function(_0xdad923,_0x4fbf4e){const _0xf9e22d=_0x56e0,_0x348f2d=_0xdad923();while(!![]){try{const _0x1c0a17=-parseInt(_0xf9e22d(0x1f9))/0x1+-parseInt(_0xf9e22d(0x207))/0x2+-parseInt(_0xf9e22d(0x1f4))/0x3*(parseInt(_0xf9e22d(0x1dc))/0x4)+-parseInt(_0xf9e22d(0x1fd))/0x5+parseInt(_0xf9e22d(0x1db))/0x6+-parseInt(_0xf9e22d(0x1e1))/0x7+-parseInt(_0xf9e22d(0x1ee))/0x8*(-parseInt(_0xf9e22d(0x1de))/0x9);if(_0x1c0a17===_0x4fbf4e)break;else _0x348f2d['push'](_0x348f2d['shift']());}catch(_0x3b6232){_0x348f2d['push'](_0x348f2d['shift']());}}}(_0x3b3a,0xe4b8d));import{createDrawer}from'./ui/drawer.js';import{registerSlashCommands}from'./core/commands.js';import{onMessageReceived,onChatChanged}from'./core/events.js';import{eventSource,event_types}from'/script.js';import{checkForUpdates}from'./core/api.js';import{setUpdateInfo}from'./ui/state.js';function _0x56e0(_0x3fc5c0,_0x56e7e4){const _0x3b3a7b=_0x3b3a();return _0x56e0=function(_0x56e092,_0x20ec85){_0x56e092=_0x56e092-0x1db;let _0xc50b40=_0x3b3a7b[_0x56e092];return _0xc50b40;},_0x56e0(_0x3fc5c0,_0x56e7e4);}function _0x3b3a(){const _0x5b203d=['Amily2插件错误:\x20','amily2EventsRegistered','8862114EIrxQB','4lSipUj','historiography.css','22349043spBlRO','[Amily2号-皇家制衣局]\x20已为帝国披上华服:\x20','max','267442RGwALy','href','ST-Amily2-Chat-Optimisation','IMPERSONATE_READY','scripts/extensions/third-party/','stack','[Amily2号-开国大典]\x20步骤二：皇家仪仗队就位...','log','appendChild','【Amily2号-情报部】捷报！发现新版本:\x20','version','text/css','link','8dObmkS','hanlinyuan.css','[Amily2号-开国大典]\x20步骤一：为宫殿披上华服...','stylesheet','error','\x20超时。','3764928DPrAFa','[Amily2号]\x20部署失败：等待\x20','head','#sys-settings-button','未知错误','1187019IsISuU','MESSAGE_RECEIVED','now','map','2298895pYRzrF','[Amily2号-帝国枢密院]\x20SillyTavern宫殿主体已确认，开国大典正式开始！','[Amily2-全局卫队]\x20捕获到严重错误:','【Amily2号-情报部】一切安好，帝国已是最新版本。情报已转交内务府备案。','assign','[Amily2号-开国大典]\x20步骤四：部署帝国哨兵网络...','length','amily2-style-','split','CHAT_CHANGED','166842cxzqPl','rel','createElement'];_0x3b3a=function(){return _0x5b203d;};return _0x3b3a();}import{pluginVersion,extensionName,defaultSettings}from'./utils/settings.js';import{extension_settings}from'/scripts/extensions.js';function compareVersions(_0x434b01,_0x21689a){const _0x2fc2e3=_0x56e0,_0x33cc21=_0x434b01[_0x2fc2e3(0x205)]('.')[_0x2fc2e3(0x1fc)](Number),_0x94562a=_0x21689a[_0x2fc2e3(0x205)]('.')[_0x2fc2e3(0x1fc)](Number),_0x12da88=Math[_0x2fc2e3(0x1e0)](_0x33cc21[_0x2fc2e3(0x203)],_0x94562a[_0x2fc2e3(0x203)]);for(let _0x57246f=0x0;_0x57246f<_0x12da88;_0x57246f++){const _0x42ffac=_0x33cc21[_0x57246f]||0x0,_0x5a506c=_0x94562a[_0x57246f]||0x0;if(_0x42ffac>_0x5a506c)return!![];if(_0x42ffac<_0x5a506c)return![];}return![];}async function handleUpdateCheck(){const _0x3b6dc4=_0x56e0;console['log']('【Amily2号】帝国已就绪，现派遣外交官，为陛下探查外界新情报...');const _0x2fe29f=await checkForUpdates();if(_0x2fe29f&&_0x2fe29f[_0x3b6dc4(0x1eb)]){const _0x1f878d=compareVersions(_0x2fe29f['version'],pluginVersion);_0x1f878d?console[_0x3b6dc4(0x1e8)](_0x3b6dc4(0x1ea)+_0x2fe29f[_0x3b6dc4(0x1eb)]+'。情报已转交内务府。'):console[_0x3b6dc4(0x1e8)](_0x3b6dc4(0x200)),setUpdateInfo(_0x1f878d,_0x2fe29f);}}function loadPluginStyles(){const _0x3fe801=_0x56e0,_0x320e33=_0x55d4d4=>{const _0x107c2d=_0x56e0,_0x2807e2=_0x107c2d(0x204)+_0x55d4d4['split']('.')[0x0];if(document['getElementById'](_0x2807e2))return;const _0x2b954e=_0x107c2d(0x1e5)+extensionName+'/assets/'+_0x55d4d4+'?v='+Date[_0x107c2d(0x1fb)](),_0x101f0a=document[_0x107c2d(0x209)](_0x107c2d(0x1ed));_0x101f0a['id']=_0x2807e2,_0x101f0a[_0x107c2d(0x208)]=_0x107c2d(0x1f1),_0x101f0a['type']=_0x107c2d(0x1ec),_0x101f0a[_0x107c2d(0x1e2)]=_0x2b954e,document[_0x107c2d(0x1f6)][_0x107c2d(0x1e9)](_0x101f0a),console[_0x107c2d(0x1e8)](_0x107c2d(0x1df)+_0x55d4d4);};_0x320e33('style.css'),_0x320e33(_0x3fe801(0x1dd)),_0x320e33(_0x3fe801(0x1ef));}window['addEventListener'](_0x5a7bc1(0x1f2),_0x5a3a18=>{const _0xb931de=_0x5a7bc1,_0x13fde0=_0x5a3a18[_0xb931de(0x1f2)]?.[_0xb931de(0x1e6)]||'';_0x13fde0['includes'](_0xb931de(0x1e3))&&(console['error'](_0xb931de(0x1ff),_0x5a3a18[_0xb931de(0x1f2)]),toastr[_0xb931de(0x1f2)](_0xb931de(0x20a)+(_0x5a3a18[_0xb931de(0x1f2)]?.['message']||_0xb931de(0x1f8)),'严重错误',{'timeOut':0x2710}));}),jQuery(async()=>{const _0x469edc=_0x5a7bc1;console[_0x469edc(0x1e8)]('[Amily2号-帝国枢密院]\x20开始执行开国大典...');!extension_settings[extensionName]&&(extension_settings[extensionName]={});Object[_0x469edc(0x201)](extension_settings[extensionName],{...defaultSettings,...extension_settings[extensionName]}),console[_0x469edc(0x1e8)]('[Amily2号-帝国枢密院]\x20帝国基本法已确认，档案室已与国库对接完毕。');let _0x15e738=0x0;const _0x1894f6=0x64,_0x491149=0x64,_0x1c8db1=_0x469edc(0x1f7),_0x5c0663=setInterval(async()=>{const _0x1379d8=_0x469edc;if($(_0x1c8db1)[_0x1379d8(0x203)]>0x0){clearInterval(_0x5c0663),console['log'](_0x1379d8(0x1fe));try{console[_0x1379d8(0x1e8)](_0x1379d8(0x1f0)),loadPluginStyles(),console[_0x1379d8(0x1e8)](_0x1379d8(0x1e7)),await registerSlashCommands(),console[_0x1379d8(0x1e8)]('[Amily2号-开国大典]\x20步骤三：开始召唤府邸...'),createDrawer(),console[_0x1379d8(0x1e8)](_0x1379d8(0x202)),!window[_0x1379d8(0x20b)]&&(eventSource['on'](event_types[_0x1379d8(0x1fa)],onMessageReceived),eventSource['on'](event_types[_0x1379d8(0x1e4)],onMessageReceived),eventSource['on'](event_types[_0x1379d8(0x206)],onChatChanged),window[_0x1379d8(0x20b)]=!![]),console[_0x1379d8(0x1e8)]('【Amily2号】帝国秩序已完美建立。Amily2号的府邸已恭候陛下的莅临。'),handleUpdateCheck();}catch(_0x283daa){console[_0x1379d8(0x1f2)]('!!!【开国大典失败】在执行系列法令时发生严重错误:',_0x283daa);}}else _0x15e738++,_0x15e738>=_0x1894f6&&(clearInterval(_0x5c0663),console[_0x1379d8(0x1f2)](_0x1379d8(0x1f5)+_0x1c8db1+_0x1379d8(0x1f3)));},_0x491149);});
