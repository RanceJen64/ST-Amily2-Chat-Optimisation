const _0x2b2248=_0x5115;(function(_0x355ede,_0x547189){const _0x2f7c22=_0x5115,_0x545ab7=_0x355ede();while(!![]){try{const _0x32f275=parseInt(_0x2f7c22(0x233))/0x1+-parseInt(_0x2f7c22(0x1f7))/0x2+parseInt(_0x2f7c22(0x22c))/0x3+parseInt(_0x2f7c22(0x1e8))/0x4+parseInt(_0x2f7c22(0x205))/0x5*(parseInt(_0x2f7c22(0x1cd))/0x6)+parseInt(_0x2f7c22(0x24a))/0x7*(-parseInt(_0x2f7c22(0x21f))/0x8)+parseInt(_0x2f7c22(0x1d3))/0x9*(-parseInt(_0x2f7c22(0x21b))/0xa);if(_0x32f275===_0x547189)break;else _0x545ab7['push'](_0x545ab7['shift']());}catch(_0x2d9377){_0x545ab7['push'](_0x545ab7['shift']());}}}(_0xf08d,0x8ee44));import{extension_settings}from'/scripts/extensions.js';import{saveSettingsDebounced}from'/script.js';import{defaultSettings,extensionName}from'../utils/settings.js';import{pluginAuthStatus,activatePluginAuthorization,getPasswordForDate}from'../utils/auth.js';import{fetchSupportedModels}from'../core/api.js';import{setAvailableModels,populateModelDropdown,getLatestUpdateInfo}from'./state.js';import{fixCommand,testReplyChecker}from'../core/commands.js';import{createDrawer}from'../ui/drawer.js';import{messageFormatting}from'/script.js';import{executeManualCommand}from'../core/autoHideManager.js';import{showContentModal,showHtmlModal}from'./page-window.js';function _0x5115(_0x31c0ac,_0xd2d0e6){const _0x511500=_0xf08d();return _0x5115=function(_0x1839e7,_0xbcb068){_0x1839e7=_0x1839e7-0x1a1;let _0x38663e=_0x511500[_0x1839e7];return _0x38663e;},_0x5115(_0x31c0ac,_0xd2d0e6);}function displayDailyAuthCode(){const _0x1f594a=_0x5115,_0x5b8571=document[_0x1f594a(0x1b4)](_0x1f594a(0x1d5)),_0x2aab55=document[_0x1f594a(0x1b4)](_0x1f594a(0x20d));if(_0x5b8571&&_0x2aab55){const _0xf57990=getPasswordForDate(new Date());_0x5b8571[_0x1f594a(0x246)]=_0xf57990,_0x2aab55['addEventListener'](_0x1f594a(0x203),()=>{const _0x1b3e3e=_0x1f594a;navigator[_0x1b3e3e(0x1df)][_0x1b3e3e(0x235)](_0xf57990)['then'](()=>{const _0x498147=_0x1b3e3e;toastr[_0x498147(0x24c)](_0x498147(0x1da));},()=>{const _0x1e7f8b=_0x1b3e3e;toastr[_0x1e7f8b(0x1af)](_0x1e7f8b(0x1f0));});});}}export function bindModalEvents(){const _0x282b0e=_0x5115,_0x524386=$(_0x282b0e(0x21a))[_0x282b0e(0x1e5)]?$(_0x282b0e(0x21a)):$(_0x282b0e(0x1d8));displayDailyAuthCode();function _0x2283d2(){const _0x1c6da0=_0x282b0e,_0x4e29a3=extension_settings[extensionName]||{},_0x300462=_0x4e29a3[_0x1c6da0(0x1fb)]===!![],_0x476ca3=_0x4e29a3[_0x1c6da0(0x1b7)]||'';_0x524386[_0x1c6da0(0x1a8)](_0x1c6da0(0x1ea))[_0x1c6da0(0x24b)](_0x1c6da0(0x218),_0x300462),_0x524386[_0x1c6da0(0x1a8)](_0x1c6da0(0x1a6))[_0x1c6da0(0x1ae)](_0x476ca3);const _0x881c40=_0x524386[_0x1c6da0(0x1a8)](_0x1c6da0(0x23c)),_0x55be9e=_0x524386[_0x1c6da0(0x1a8)]('#amily2_manual_model_input');_0x300462?(_0x881c40[_0x1c6da0(0x1f9)](),_0x55be9e[_0x1c6da0(0x20f)]()):(_0x881c40[_0x1c6da0(0x20f)](),_0x55be9e['hide']());}if(!_0x524386[_0x282b0e(0x1e5)]||_0x524386[_0x282b0e(0x208)](_0x282b0e(0x1bb)))return;const _0x1440b2=_0x30ccef=>_0x30ccef['replace'](/_([a-z])/g,_0x1dc5ab=>_0x1dc5ab[0x1][_0x282b0e(0x1cb)]()),_0x39de7f=(_0xb4c539,_0x4b0aef)=>{const _0x2960f8=_0x282b0e;console[_0x2960f8(0x1c2)]('[Amily-谕令确认]\x20收到指令:\x20将\x20['+_0xb4c539+_0x2960f8(0x20b),_0x4b0aef),!extension_settings[extensionName]&&(extension_settings[extensionName]={}),extension_settings[extensionName]={...extension_settings[extensionName],[_0xb4c539]:_0x4b0aef},saveSettingsDebounced(),console[_0x2960f8(0x1c2)](_0x2960f8(0x20c)+_0xb4c539+_0x2960f8(0x1fc));};_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1e2))['on']('change.amily2.force_proxy',_0x282b0e(0x1ea),function(){const _0x5c16dc=_0x282b0e;if(!pluginAuthStatus[_0x5c16dc(0x1bd)])return;_0x39de7f('forceProxyForCustomApi',this[_0x5c16dc(0x218)]),_0x2283d2();}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1c3))['on']('change.amily2.manual_model','#amily2_manual_model_input',function(){const _0xb51043=_0x282b0e;if(!pluginAuthStatus['authorized'])return;_0x39de7f('model',this[_0xb51043(0x1b6)]),toastr['success'](_0xb51043(0x1ab)+this[_0xb51043(0x1b6)]+_0xb51043(0x1d2),_0xb51043(0x216));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1bf))['on'](_0x282b0e(0x1bf),_0x282b0e(0x1d4),async function(){const _0x268c26=_0x282b0e,_0x4bc2ac=$(_0x268c26(0x22f))[_0x268c26(0x1ae)]()[_0x268c26(0x223)]();_0x4bc2ac?await activatePluginAuthorization(_0x4bc2ac):toastr['warning']('请输入授权码',_0x268c26(0x216));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1b3))['on'](_0x282b0e(0x1b3),_0x282b0e(0x1c4),async function(){const _0x3b3150=_0x282b0e;if(!pluginAuthStatus[_0x3b3150(0x1bd)])return;const _0x2b8cf1=$(this),_0x18408b=_0x2b8cf1[_0x3b3150(0x1a1)]();_0x2b8cf1[_0x3b3150(0x24b)](_0x3b3150(0x202),!![])[_0x3b3150(0x1a1)]('<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20处理中');try{switch(this['id']){case _0x3b3150(0x1f5):const _0x30b3fc=await fetchSupportedModels();_0x30b3fc[_0x3b3150(0x1e5)]>0x0&&(setAvailableModels(_0x30b3fc),localStorage[_0x3b3150(0x1ba)](_0x3b3150(0x217),JSON[_0x3b3150(0x1a4)](_0x30b3fc)),populateModelDropdown());break;case'amily2_test':await testReplyChecker();break;case _0x3b3150(0x248):await fixCommand();break;}}catch(_0x106d63){console['error'](_0x3b3150(0x220)+this['id']+_0x3b3150(0x1ec),_0x106d63),toastr[_0x3b3150(0x1af)](_0x3b3150(0x22b)+_0x106d63[_0x3b3150(0x1b2)],_0x3b3150(0x216));}finally{_0x2b8cf1[_0x3b3150(0x24b)](_0x3b3150(0x202),![])['html'](_0x18408b);}}),_0x524386['off'](_0x282b0e(0x1dc))['on']('click.amily2.expand_editor',_0x282b0e(0x231),function(_0x54562f){const _0x79b6f8=_0x282b0e;if(!pluginAuthStatus[_0x79b6f8(0x1bd)])return;_0x54562f[_0x79b6f8(0x1f4)]();const _0x402615=$(_0x79b6f8(0x247))[_0x79b6f8(0x1ae)](),_0x20d39d=$(_0x79b6f8(0x1cc))[_0x79b6f8(0x1ae)](),_0x34e0cd=_0x79b6f8(0x225)+_0x402615+_0x79b6f8(0x206),_0x4e7a07=$(_0x34e0cd)[_0x79b6f8(0x1e3)]('body'),_0x36bbbd=_0x4e7a07[_0x79b6f8(0x1a8)](_0x79b6f8(0x1ce));_0x36bbbd['val'](_0x20d39d);const _0x2ad5ab=()=>{const _0x4ab0c0=_0x79b6f8;_0x4e7a07[0x0][_0x4ab0c0(0x239)](),_0x4e7a07[_0x4ab0c0(0x219)]();};_0x4e7a07[_0x79b6f8(0x1a8)](_0x79b6f8(0x23d))['on'](_0x79b6f8(0x203),()=>{const _0x1d60d8=_0x79b6f8,_0x83c064=_0x36bbbd[_0x1d60d8(0x1ae)]();$(_0x1d60d8(0x1cc))[_0x1d60d8(0x1ae)](_0x83c064),_0x39de7f(_0x402615,_0x83c064),toastr[_0x1d60d8(0x24c)](_0x1d60d8(0x1fa)+_0x402615+_0x1d60d8(0x21e),_0x1d60d8(0x216)),_0x2ad5ab();}),_0x4e7a07[_0x79b6f8(0x1a8)](_0x79b6f8(0x1dd))['on']('click',_0x2ad5ab),_0x4e7a07[0x0]['showModal']();}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x243))['on'](_0x282b0e(0x243),'#amily2_open_tutorial,\x20#amily2_open_neige_tutorial',function(){const _0x354eaf=_0x282b0e;if(!pluginAuthStatus[_0x354eaf(0x1bd)])return;const _0x13be9c={'amily2_open_tutorial':{'title':'主殿使用教程','url':_0x354eaf(0x21c)},'amily2_open_neige_tutorial':{'title':_0x354eaf(0x22d),'url':_0x354eaf(0x227)}},_0x2c1694=_0x13be9c[this['id']];_0x2c1694&&showContentModal(_0x2c1694[_0x354eaf(0x1ad)],_0x2c1694['url']);}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1f2))['on'](_0x282b0e(0x1f2),_0x282b0e(0x1c0),function(){const _0x4e99d1=_0x282b0e;$(_0x4e99d1(0x1a7))[_0x4e99d1(0x1f9)]();const _0x1f2187=getLatestUpdateInfo();if(_0x1f2187&&_0x1f2187[_0x4e99d1(0x214)]){const _0x1f85f8=messageFormatting(_0x1f2187[_0x4e99d1(0x214)]),_0x1c715e=_0x4e99d1(0x201)+_0x1f85f8+_0x4e99d1(0x1a9),_0x2da4fd=$(_0x1c715e)['appendTo'](_0x4e99d1(0x240)),_0x467659=()=>{const _0xe5d3d8=_0x4e99d1;_0x2da4fd[0x0][_0xe5d3d8(0x239)](),_0x2da4fd[_0xe5d3d8(0x219)]();};_0x2da4fd[_0x4e99d1(0x1a8)]('.popup-button-ok')['on'](_0x4e99d1(0x203),_0x467659),_0x2da4fd[0x0][_0x4e99d1(0x1b0)]();}else toastr[_0x4e99d1(0x1b8)]('未能获取到云端情报，请稍后再试。',_0x4e99d1(0x215));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1a5))['on'](_0x282b0e(0x1a5),_0x282b0e(0x1cf),function(){const _0x9973a3=_0x282b0e;$(_0x9973a3(0x1f6))['first']()[_0x9973a3(0x203)]();}),_0x524386[_0x282b0e(0x1d0)]('click.amily2.manual_command')['on'](_0x282b0e(0x249),'#amily2_unhide_all_button,\x20#amily2_manual_hide_confirm,\x20#amily2_manual_unhide_confirm',async function(){const _0x196a96=_0x282b0e;if(!pluginAuthStatus[_0x196a96(0x1bd)])return;const _0xce8dba=this['id'];let _0x29fa20='',_0x4771b0={};switch(_0xce8dba){case _0x196a96(0x1ef):_0x29fa20=_0x196a96(0x213);break;case _0x196a96(0x1b5):_0x29fa20='manual_hide',_0x4771b0={'from':$(_0x196a96(0x23e))[_0x196a96(0x1ae)](),'to':$(_0x196a96(0x1c5))[_0x196a96(0x1ae)]()};break;case _0x196a96(0x22a):_0x29fa20=_0x196a96(0x207),_0x4771b0={'from':$('#amily2_manual_unhide_from')[_0x196a96(0x1ae)](),'to':$(_0x196a96(0x23b))['val']()};break;}_0x29fa20&&await executeManualCommand(_0x29fa20,_0x4771b0);}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1d1))['on'](_0x282b0e(0x1d1),_0x282b0e(0x1e0),function(){const _0x128303=_0x282b0e;if(!pluginAuthStatus['authorized'])return;const _0x264ee4=_0x524386[_0x128303(0x1a8)]('.plugin-features'),_0x57d572=_0x524386[_0x128303(0x1a8)](_0x128303(0x1ed)),_0x49652b=_0x524386['find']('#amily2_hanlinyuan_panel');_0x264ee4[_0x128303(0x1f9)](),_0x57d572['hide'](),_0x49652b[_0x128303(0x1f9)]();switch(this['id']){case _0x128303(0x23a):_0x57d572[_0x128303(0x20f)]();break;case _0x128303(0x1c8):_0x49652b[_0x128303(0x20f)]();break;case _0x128303(0x20e):case _0x128303(0x1fd):_0x264ee4[_0x128303(0x20f)]();break;}}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x238))['on']('change.amily2.checkbox',_0x282b0e(0x237),function(_0x52bdf7){const _0x5d46bc=_0x282b0e;if(!pluginAuthStatus[_0x5d46bc(0x1bd)])return;const _0x3583eb=this['id'],_0x3f9967=$(this),_0x52ac6e=_0x1440b2(_0x3583eb[_0x5d46bc(0x1d7)]('amily2_',''));_0x39de7f(_0x52ac6e,_0x3f9967[_0x5d46bc(0x24b)](_0x5d46bc(0x218)));if(_0x3583eb==='amily2_optimization_exclusion_enabled'&&_0x3f9967[_0x5d46bc(0x24b)](_0x5d46bc(0x218))){const _0x3a92f9=extension_settings[extensionName],_0x50b222=_0x3a92f9[_0x5d46bc(0x1f3)]||[],_0x3ce133=(_0x141947={'start':'','end':''},_0x2b7598)=>_0x5d46bc(0x1c9)+_0x2b7598+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22text_pole\x22\x20value=\x22'+_0x141947[_0x5d46bc(0x236)]+_0x5d46bc(0x1f1)+_0x141947['end']+'\x22\x20placeholder=\x22结束字符,\x20如\x20-->\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-rule-btn\x20menu_button\x20danger_button\x22\x20title=\x22删除此规则\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',_0x43dc77=_0x50b222[_0x5d46bc(0x1a2)](_0x3ce133)[_0x5d46bc(0x1b1)](''),_0x5f4f27='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22optimization-exclusion-rules-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22notes\x22>在这里定义需要从优化内容中排除的文本片段。例如，排除HTML注释，可以设置开始字符为\x20`<!--`，结束字符为\x20`-->`。</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22optimization-rules-list\x22\x20style=\x22max-height:\x2045vh;\x20overflow-y:\x20auto;\x20padding:\x2010px;\x20border:\x201px\x20solid\x20rgba(255,255,255,0.1);\x20border-radius:\x205px;\x20margin-bottom:10px;\x22>'+_0x43dc77+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22optimization-add-rule-btn\x22\x20class=\x22menu_button\x20amily2-add-rule-btn\x22><i\x20class=\x22fas\x20fa-plus\x22></i>\x20添加新规则</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';showHtmlModal(_0x5d46bc(0x1a3),_0x5f4f27,{'okText':'确认','cancelText':'取消','onOk':_0x9a07e5=>{const _0x220ca9=_0x5d46bc,_0x2c60f0=[];_0x9a07e5[_0x220ca9(0x1a8)]('.opt-exclusion-rule-row')[_0x220ca9(0x209)](function(){const _0x2d97e6=_0x220ca9,_0x55860a=$(this)[_0x2d97e6(0x1a8)](_0x2d97e6(0x1eb))['eq'](0x0)['val']()[_0x2d97e6(0x223)](),_0x51a93f=$(this)[_0x2d97e6(0x1a8)](_0x2d97e6(0x1eb))['eq'](0x1)[_0x2d97e6(0x1ae)]()['trim']();if(_0x55860a&&_0x51a93f)_0x2c60f0[_0x2d97e6(0x232)]({'start':_0x55860a,'end':_0x51a93f});}),_0x39de7f('optimizationExclusionRules',_0x2c60f0),toastr[_0x220ca9(0x24c)](_0x220ca9(0x21d),_0x220ca9(0x216));},'onCancel':()=>{}});const _0x3c6ed0=$(_0x5d46bc(0x212)),_0x4eb0a6=_0x3c6ed0[_0x5d46bc(0x1a8)](_0x5d46bc(0x1de));_0x3c6ed0[_0x5d46bc(0x1a8)]('#optimization-add-rule-btn')['on'](_0x5d46bc(0x203),()=>{const _0xb3ffe8=_0x5d46bc,_0x49ecd8=_0x4eb0a6[_0xb3ffe8(0x245)]()['length'];_0x4eb0a6[_0xb3ffe8(0x244)](_0x3ce133(undefined,_0x49ecd8));}),_0x4eb0a6['on']('click',_0x5d46bc(0x1db),function(){const _0x157915=_0x5d46bc;$(this)['closest'](_0x157915(0x1c7))[_0x157915(0x219)]();});}}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1b9))['on'](_0x282b0e(0x1b9),'input[type=\x22radio\x22][name^=\x22amily2_\x22]:not([name=\x22amily2_icon_location\x22])',function(){const _0x57e505=_0x282b0e;if(!pluginAuthStatus[_0x57e505(0x1bd)])return;const _0xcc0b6e=_0x1440b2(this[_0x57e505(0x23f)][_0x57e505(0x1d7)]('amily2_','')),_0x4eb604=$('input[name=\x22'+this['name']+_0x57e505(0x200))[_0x57e505(0x1ae)]();_0x39de7f(_0xcc0b6e,_0x4eb604);}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1ff))['on'](_0x282b0e(0x1ff),'#amily2_api_url,\x20#amily2_api_key,\x20#amily2_optimization_target_tag',function(){const _0x5bbd4a=_0x282b0e;if(!pluginAuthStatus[_0x5bbd4a(0x1bd)])return;const _0x304021=_0x1440b2(this['id'][_0x5bbd4a(0x1d7)](_0x5bbd4a(0x229),''));_0x39de7f(_0x304021,this[_0x5bbd4a(0x1b6)]),toastr[_0x5bbd4a(0x24c)]('配置\x20['+_0x304021+_0x5bbd4a(0x1d2),_0x5bbd4a(0x216));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1d9))['on'](_0x282b0e(0x1d9),_0x282b0e(0x224),function(){const _0x53964b=_0x282b0e;if(!pluginAuthStatus[_0x53964b(0x1bd)])return;const _0x35dffa=_0x1440b2(this['id'][_0x53964b(0x1d7)]('amily2_',''));_0x39de7f(_0x35dffa,this['value']),populateModelDropdown();}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x211))['on']('input.amily2.range','input[type=\x22range\x22][id^=\x22amily2_\x22]',function(){const _0x17e3a9=_0x282b0e;if(!pluginAuthStatus[_0x17e3a9(0x1bd)])return;const _0xd75edd=_0x1440b2(this['id'][_0x17e3a9(0x1d7)](_0x17e3a9(0x229),'')),_0x12a659=this['id'][_0x17e3a9(0x1c1)](_0x17e3a9(0x241))?parseFloat(this[_0x17e3a9(0x1b6)]):parseInt(this[_0x17e3a9(0x1b6)],0xa);$('#'+this['id']+_0x17e3a9(0x1c6))['text'](_0x12a659),_0x39de7f(_0xd75edd,_0x12a659);});const _0x580b03={'mainPrompt':_0x282b0e(0x1ca),'systemPrompt':'#amily2_system_prompt','outputFormatPrompt':_0x282b0e(0x230)},_0x9cf789=_0x282b0e(0x247),_0x2941d5='#amily2_unified_editor',_0x1fc62f=_0x282b0e(0x1ee);function _0x477b5b(){const _0x1724f7=_0x282b0e;if(!$(_0x9cf789)[_0x1724f7(0x1e5)])return;const _0x21f18d=$(_0x9cf789)[_0x1724f7(0x1ae)]();if(!_0x21f18d)return;const _0x3b94d0=extension_settings[extensionName][_0x21f18d]||'';$(_0x2941d5)[_0x1724f7(0x1ae)](_0x3b94d0);}_0x524386['off'](_0x282b0e(0x1f8))['on'](_0x282b0e(0x1f8),_0x9cf789,_0x477b5b),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x234))['on']('click.amily2.unified_save',_0x1fc62f,function(){const _0x2a89bf=_0x282b0e,_0x36852e=$(_0x9cf789)['val']();if(!_0x36852e)return;const _0xc4bae8=$(_0x2941d5)[_0x2a89bf(0x1ae)]();_0x39de7f(_0x36852e,_0xc4bae8),toastr[_0x2a89bf(0x24c)](_0x2a89bf(0x1fa)+_0x36852e+']\x20已镌刻!',_0x2a89bf(0x216));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1bc))['on']('click.amily2.unified_restore',_0x282b0e(0x1e6),function(){const _0x424d7c=_0x282b0e,_0x2c2700=$(_0x9cf789)[_0x424d7c(0x1ae)]();if(!_0x2c2700)return;const _0x21dbcf=defaultSettings[_0x2c2700];$(_0x2941d5)[_0x424d7c(0x1ae)](_0x21dbcf),_0x39de7f(_0x2c2700,_0x21dbcf),toastr[_0x424d7c(0x24c)](_0x424d7c(0x1fa)+_0x2c2700+']\x20已成功恢复为帝国初始蓝图。',_0x424d7c(0x216));}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x221))['on'](_0x282b0e(0x221),_0x282b0e(0x1e9),function(){const _0x37a5d8=_0x282b0e;if(!pluginAuthStatus['authorized'])return;let _0x46bb67=_0x1440b2(this['id'][_0x37a5d8(0x1d7)](_0x37a5d8(0x229),''));_0x46bb67==='loreDepthInput'&&(_0x46bb67=_0x37a5d8(0x22e));const _0x476a5f=this[_0x37a5d8(0x226)]===_0x37a5d8(0x1e4)?parseInt(this[_0x37a5d8(0x1b6)],0xa):this[_0x37a5d8(0x1b6)];_0x39de7f(_0x46bb67,_0x476a5f);if(this['id']==='amily2_lore_insertion_position'){const _0x2deb7d=$(_0x37a5d8(0x242));this[_0x37a5d8(0x1b6)]==='at_depth'?_0x2deb7d[_0x37a5d8(0x1d6)](0xc8):_0x2deb7d['slideUp'](0xc8);}}),_0x524386[_0x282b0e(0x1d0)](_0x282b0e(0x1ac))['on'](_0x282b0e(0x1ac),_0x282b0e(0x1e7),function(){const _0x115a94=_0x282b0e;if(!pluginAuthStatus['authorized'])return;const _0x2cec6b=$(this),_0x59c0c3=$(_0x115a94(0x1e1));_0x2cec6b[_0x115a94(0x24b)]('disabled',!![])[_0x115a94(0x1a1)](_0x115a94(0x204)),_0x59c0c3['text']('圣意已在您每次更改时自动镌刻。')['stop']()[_0x115a94(0x1fe)](),setTimeout(()=>{const _0x56a60b=_0x115a94;_0x2cec6b['prop'](_0x56a60b(0x202),![])[_0x56a60b(0x1a1)](_0x56a60b(0x20a)),_0x59c0c3['fadeOut']();},0x9c4);}),setTimeout(_0x477b5b,0x64),_0x2283d2(),_0x524386[_0x282b0e(0x208)](_0x282b0e(0x1bb),!![]);}function _0xf08d(){const _0x4fc1ac=['\x22\x20placeholder=\x22开始字符,\x20如\x20<!--\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>到</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22text_pole\x22\x20value=\x22','click.amily2.update','optimizationExclusionRules','stopPropagation','amily2_refresh_models','span[data-i18n=\x22Manage\x20extensions\x22]','1818642hijchn','change.amily2.prompt_selector','hide','谕令\x20[','forceProxyForCustomApi',']\x20的新状态已保存。','amily2_back_to_main_from_hanlinyuan','fadeIn','change.amily2.text','\x22]:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<dialog\x20class=\x22popup\x20wide_dialogue_popup\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:0;\x20color:\x20#eee;\x20border-bottom:\x201px\x20solid\x20rgba(255,255,255,0.2);\x20padding-bottom:\x2010px;\x22><i\x20class=\x22fas\x20fa-bell\x22\x20style=\x22color:\x20#ff9800;\x22></i>\x20帝国最新情报</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-content\x22\x20style=\x22height:\x2060vh;\x20overflow-y:\x20auto;\x20background:\x20rgba(0,0,0,0.2);\x20padding:\x2015px;\x20border-radius:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22mes_text\x22>','disabled','click','<i\x20class=\x22fas\x20fa-check\x22></i>\x20已确认','1326975RrAgkS','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-content\x22\x20style=\x22height:\x2070vh;\x22><div\x20class=\x22height100p\x20wide100p\x20flex-container\x22><textarea\x20id=\x22amily2_dialog_editor\x22\x20class=\x22height100p\x20wide100p\x20maximized_textarea\x20text_pole\x22></textarea></div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-controls\x22><div\x20class=\x22popup-button-ok\x20menu_button\x20menu_button_primary\x20interactable\x22>保存并关闭</div><div\x20class=\x22popup-button-cancel\x20menu_button\x20interactable\x22\x20style=\x22margin-left:\x2010px;\x22>取消</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</dialog>','manual_unhide','data','each','<i\x20class=\x22fas\x20fa-save\x22></i>\x20确认敕令',']\x20设置为\x20->','[Amily-谕令镌刻]\x20[','amily2_copy_daily_code','amily2_back_to_main_settings','show','扩展区','input.amily2.range','#optimization-exclusion-rules-container','unhide_all','changelog','情报部回报','Amily2号','cached_models_amily2','checked','remove','#amily2_drawer_content','140qaRpOP','scripts/extensions/third-party/ST-Amily2-Chat-Optimisation/ZhuDian.md','排除规则已更新。',']\x20已镌刻！','2336vzYJet','[Amily2-工部]\x20操作按钮\x20','change.amily2.lore_settings','input[name=\x22amily2_icon_location\x22]','trim','select#amily2_model','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<dialog\x20class=\x22popup\x20wide_dialogue_popup\x20large_dialogue_popup\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4\x20style=\x22margin-top:0;\x20color:\x20#eee;\x20border-bottom:\x201px\x20solid\x20rgba(255,255,255,0.2);\x20padding-bottom:\x2010px;\x22>正在编辑:\x20','type','scripts/extensions/third-party/ST-Amily2-Chat-Optimisation/NeiGe.md','。圣意已存档。','amily2_','amily2_manual_unhide_confirm','操作失败:\x20','992271gDvdym','内阁使用教程','loreDepth','#amily2_auth_code','#amily2_output_format_prompt','#amily2_expand_editor','push','990715pKtRkr','click.amily2.unified_save','writeText','start','input[type=\x22checkbox\x22][id^=\x22amily2_\x22]','change.amily2.checkbox','close','amily2_open_additional_features','#amily2_manual_unhide_to','#amily2_model_autofetch_wrapper','.popup-button-ok','#amily2_manual_hide_from','name','body','temperature','#amily2_lore_depth_container','click.amily2.tutorial','append','children','textContent','#amily2_prompt_selector','amily2_fix_now','click.amily2.manual_command','18494FJsbLs','prop','success','html','map','编辑内容排除规则','stringify','click.amily2.update_new','#amily2_manual_model_input','#amily2_update_indicator','find','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popup-controls\x22><div\x20class=\x22popup-button-ok\x20menu_button\x20menu_button_primary\x20interactable\x22>朕已阅</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</dialog>','正在将帝国徽记迁往\x20[','模型ID\x20[','click.amily2.lore_save','title','val','error','showModal','join','message','click.amily2.actions','getElementById','amily2_manual_hide_confirm','value','model','info','change.amily2.radio','setItem','events-bound','click.amily2.unified_restore','authorized','#amily2_extension_frame','click.amily2.auth','#amily2_update_button','includes','log','change.amily2.manual_model','#amily2_refresh_models,\x20#amily2_test,\x20#amily2_fix_now','#amily2_manual_hide_to','_value','.opt-exclusion-rule-row','amily2_open_rag_palace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22opt-exclusion-rule-row\x22\x20data-index=\x22','#amily2_main_prompt','toUpperCase','#amily2_unified_editor','6MqTUbE','#amily2_dialog_editor','#amily2_update_button_new','off','click.amily2.chamber_nav',']\x20已自动保存!','219690eGDIuo','#auth_submit','amily2_daily_code_display','slideDown','replace','#amily2_chat_optimiser','change.amily2.select','授权码已复制到剪贴板！','.delete-rule-btn','click.amily2.expand_editor','.popup-button-cancel','#optimization-rules-list','clipboard','#amily2_open_additional_features,\x20#amily2_open_rag_palace,\x20#amily2_back_to_main_settings,\x20#amily2_back_to_main_from_hanlinyuan','#amily2_lore_save_status','change.amily2.force_proxy','appendTo','number','length','#amily2_unified_restore_button','#amily2_save_lore_settings','4083768pdzCYY','select[id^=\x22amily2_lore_\x22],\x20input#amily2_lore_depth_input','#amily2_force_proxy','input','\x20执行失败:','#amily2_additional_features_panel','#amily2_unified_save_button','amily2_unhide_all_button','复制失败，请手动复制。'];_0xf08d=function(){return _0x4fc1ac;};return _0xf08d();}$(document)['on']('change',_0x2b2248(0x222),function(){const _0x8152ed=_0x2b2248;if(!pluginAuthStatus[_0x8152ed(0x1bd)])return;const _0x3f14a2=$(this)['val']();extension_settings[extensionName]['iconLocation']=_0x3f14a2,saveSettingsDebounced(),console[_0x8152ed(0x1c2)]('[Amily-禁卫军]\x20收到迁都指令\x20->\x20'+_0x3f14a2+_0x8152ed(0x228)),toastr[_0x8152ed(0x1b8)](_0x8152ed(0x1aa)+(_0x3f14a2==='topbar'?'顶栏':_0x8152ed(0x210))+']...','迁都令',{'timeOut':0x7d0}),$('#amily2_main_drawer')[_0x8152ed(0x219)](),$(document)['off']('mousedown.amily2Drawer'),$(_0x8152ed(0x1be))[_0x8152ed(0x219)](),setTimeout(createDrawer,0x32);});
