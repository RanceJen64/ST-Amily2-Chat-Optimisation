const _0x377238=_0x4899;(function(_0x1d8f8b,_0x595964){const _0x568b61=_0x4899,_0x12823c=_0x1d8f8b();while(!![]){try{const _0xe95d73=-parseInt(_0x568b61(0x7c))/0x1*(parseInt(_0x568b61(0xbc))/0x2)+-parseInt(_0x568b61(0x78))/0x3+-parseInt(_0x568b61(0x7d))/0x4*(-parseInt(_0x568b61(0x9c))/0x5)+parseInt(_0x568b61(0x93))/0x6*(-parseInt(_0x568b61(0xb1))/0x7)+-parseInt(_0x568b61(0xb6))/0x8*(parseInt(_0x568b61(0x9a))/0x9)+-parseInt(_0x568b61(0x97))/0xa+-parseInt(_0x568b61(0x8f))/0xb*(-parseInt(_0x568b61(0x98))/0xc);if(_0xe95d73===_0x595964)break;else _0x12823c['push'](_0x12823c['shift']());}catch(_0x521cf0){_0x12823c['push'](_0x12823c['shift']());}}}(_0x1307,0x1dff5));import{renderExtensionTemplateAsync}from'/scripts/extensions.js';import{POPUP_TYPE,Popup}from'/scripts/popup.js';import{extensionName}from'../utils/settings.js';function _0x4899(_0xaafa4a,_0x16379e){const _0x130734=_0x1307();return _0x4899=function(_0x4899a5,_0x3873c8){_0x4899a5=_0x4899a5-0x78;let _0x4ebbe4=_0x130734[_0x4899a5];return _0x4ebbe4;},_0x4899(_0xaafa4a,_0x16379e);}const preOptimizationViewerPath=_0x377238(0xbb)+extensionName+_0x377238(0xb3);function _0x1307(){const _0x1d12e5=['preOptimizationTextUpdated','third-party/','1772SWjHES','list-group-item','【查看器】','getElementById','#pre-optimization-content','705981wRnaZW','add','click','优化前文查看器已开启。','31CuHLzC','20856FBLKSl','createElement','remove','<i\x20class=\x22fa-solid\x20fa-file-alt\x22></i><span>查看优化前文</span>','lastPreOptimizationText','info','top','var(--primary-color)','div','white','template','clientY','flex','translate(-50%,\x20-50%)','left','css','val','flexGap5','81323lmzwiJ','extensionsMenu','find','body','3030sQlnGb','优化前文查看器已关闭。','flex-container','center','2357720SoGQXQ','1284kFlDQf','50px','18eDpeBZ','pre-optimization-viewer-btn','135oBwgUr','offset','title','9998','优化前文','.popup:visible','mousedown','html','mousemove','fixed','addEventListener','.popup-header\x20h4','interactable','success','classList','show','filter','50%','appendChild','cursor','pointer','931nYfuFz','length','/PreOptimizationViewer','append','正在等待新的优化前文...','972920HXbXCk','0\x202px\x2010px\x20rgba(0,0,0,0.3)','<i\x20class=\x22fa-solid\x20fa-file-alt\x20fa-lg\x22></i>','clientX'];_0x1307=function(){return _0x1d12e5;};return _0x1307();}let viewerOrb=null;function addViewerButton(){const _0x15d0bf=_0x377238,_0x113f73=document[_0x15d0bf(0x7e)](_0x15d0bf(0x85));_0x113f73['id']=_0x15d0bf(0x9b),_0x113f73[_0x15d0bf(0xaa)][_0x15d0bf(0x79)](_0x15d0bf(0xbd),_0x15d0bf(0x95),_0x15d0bf(0x8e),_0x15d0bf(0xa8)),_0x113f73['innerHTML']=_0x15d0bf(0x80),_0x113f73[_0x15d0bf(0x9e)]='打开/关闭优化前文查看器';const _0x5745fe=document[_0x15d0bf(0xbf)]('extensionsMenu');_0x5745fe&&(_0x5745fe[_0x15d0bf(0xae)](_0x113f73),$(_0x113f73)['on'](_0x15d0bf(0x7a),toggleViewerOrb));}function toggleViewerOrb(){const _0x451dc9=_0x377238;viewerOrb&&viewerOrb[_0x451dc9(0xb2)]>0x0?(viewerOrb[_0x451dc9(0x7f)](),viewerOrb=null,toastr[_0x451dc9(0x82)](_0x451dc9(0x94))):(viewerOrb=$('<div\x20id=\x22viewer-orb\x22\x20title=\x22点击查看优化前文\x20(可拖拽)\x22></div>'),viewerOrb['css']({'position':_0x451dc9(0xa5),'top':_0x451dc9(0xad),'left':'50%','transform':_0x451dc9(0x8a),'width':'50px','height':_0x451dc9(0x99),'backgroundColor':_0x451dc9(0x84),'color':_0x451dc9(0x86),'borderRadius':_0x451dc9(0xad),'display':_0x451dc9(0x89),'justifyContent':'center','alignItems':_0x451dc9(0x96),'cursor':'pointer','zIndex':_0x451dc9(0x9f),'boxShadow':_0x451dc9(0xb7)}),viewerOrb[_0x451dc9(0xa3)](_0x451dc9(0xb8)),$(_0x451dc9(0x92))[_0x451dc9(0xb4)](viewerOrb),viewerOrb['on'](_0x451dc9(0x7a),showViewerPopup),makeDraggable(viewerOrb),toastr[_0x451dc9(0x82)](_0x451dc9(0x7b)));}async function showViewerPopup(){const _0x59f46f=_0x377238,_0x3868bb=window[_0x59f46f(0x81)];if(!_0x3868bb){toastr[_0x59f46f(0x82)]('目前没有可供查看的优化前文。');return;}const _0x39601e=await renderExtensionTemplateAsync(preOptimizationViewerPath,_0x59f46f(0x87)),_0x46d221=$(_0x39601e);_0x46d221[_0x59f46f(0x91)](_0x59f46f(0xc0))[_0x59f46f(0x8d)](_0x3868bb),new Popup(_0x46d221,POPUP_TYPE['OK'],_0x59f46f(0xa0),{'wide':!![],'large':!![]})[_0x59f46f(0xab)]();}function makeDraggable(_0x114e46){const _0x486282=_0x377238;let _0x3c2886=![],_0xaf10be={'x':0x0,'y':0x0};_0x114e46['on'](_0x486282(0xa2),_0x3bc97b=>{const _0x410d25=_0x486282;_0x3c2886=!![],_0xaf10be['x']=_0x3bc97b[_0x410d25(0xb9)]-_0x114e46[_0x410d25(0x9d)]()[_0x410d25(0x8b)],_0xaf10be['y']=_0x3bc97b['clientY']-_0x114e46[_0x410d25(0x9d)]()[_0x410d25(0x83)],_0x114e46[_0x410d25(0x8c)](_0x410d25(0xaf),'grabbing');}),$(document)['on'](_0x486282(0xa4),_0x19c91a=>{const _0x10494e=_0x486282;if(!_0x3c2886)return;_0x114e46['css']({'top':_0x19c91a[_0x10494e(0x88)]-_0xaf10be['y']+'px','left':_0x19c91a[_0x10494e(0xb9)]-_0xaf10be['x']+'px','transform':'none'});}),$(document)['on']('mouseup',()=>{const _0x24eaea=_0x486282;if(!_0x3c2886)return;_0x3c2886=![],_0x114e46[_0x24eaea(0x8c)](_0x24eaea(0xaf),_0x24eaea(0xb0));});}function handleTextUpdate(){const _0x52393d=_0x377238,_0x4cc44e=$(_0x52393d(0xa1))[_0x52393d(0xac)](function(){const _0x195576=_0x52393d;return $(this)[_0x195576(0x91)](_0x195576(0xa7))['text']()['trim']()===_0x195576(0xa0);});if(_0x4cc44e[_0x52393d(0xb2)]>0x0){const _0x432889=_0x4cc44e[_0x52393d(0x91)](_0x52393d(0xc0));_0x432889[_0x52393d(0x8d)](_0x52393d(0xb5)),setTimeout(()=>{const _0x593095=_0x52393d,_0x8b087f=window['lastPreOptimizationText'];_0x432889[_0x593095(0x8d)](_0x8b087f),toastr[_0x593095(0xa9)]('优化前文已实时更新。',_0x593095(0xbe),{'timeOut':0x7d0});},0x64);}}const interval=setInterval(()=>{const _0x1246a1=_0x377238;document['getElementById'](_0x1246a1(0x90))&&(clearInterval(interval),addViewerButton(),document[_0x1246a1(0xa6)](_0x1246a1(0xba),handleTextUpdate));},0x1f4);
